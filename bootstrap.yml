- name: update packages
  hosts: all
  become: on
  tasks:
  - name:
    ansible.builtin.package:
      update_cache: yes


- name: initial tasks for neweley created machine
  hosts: all
  become: true

  tasks:
  - name: add user 
    ansible.builtin.user:
      name: amrkedra
      group: root

  - name: ADD SSH_Key_For_Ansible
    ansible.builtin.authorized_key:
      user: amrkedra
      key: 'ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJM0b3q0qmCsxsLw1IkV7qN2+sH+AN5QOi378hvL3j4/ SSH_Key_For_Ansible'
  
  - name: add sudoers file
    ansible.builtin.copy:
      src: sudoer-amrkedra
      dest: /etc/sudoers.d/amrkedra
      owner: root
      group: root
      mode: 0440